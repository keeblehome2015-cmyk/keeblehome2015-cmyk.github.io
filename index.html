<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kahoot 20-Bot Flooder â€“ 2025 Working</title>
    <style>
        body {font-family: system-ui; background: #000; color: #0f0; text-align: center; padding: 20px;}
        .box {max-width: 700px; margin: auto; background: #111; padding: 30px; border-radius: 16px; border: 2px solid #0f0;}
        h1 {font-size: 2.2rem; text-shadow: 0 0 10px #0f0;}
        .warn {background: #300; padding: 15px; border-radius: 10px; margin: 20px 0; border: 1px solid #f00;}
        input, button {width: 100%; padding: 14px; margin: 10px 0; border: 1px solid #0f0; border-radius: 10px; background: #000; color: #0f0; font-size: 1.1rem;}
        button {background: #0a0; font-weight: bold;}
        button:disabled {background: #333;}
        button:hover:not(:disabled) {background: #0c0;}
        .log {margin-top: 20px; background: #000; color: #0f0; padding: 15px; border-radius: 10px; max-height: 300px; overflow: auto; font-family: monospace; text-align: left; border: 1px solid #0f0;}
        .bot {background: #001a00; margin: 5px 0; padding: 10px; border-radius: 8px; border: 1px solid #0f0;}
        .ok {color: #0f0;} .err {color: #f55;} .inf {color: #ff0;}
        .tip {background: #022; padding: 10px; border-radius: 8px; margin: 10px 0; border: 1px solid #ff0;}
    </style>
</head>
<body>
<div class="box">
    <h1>KAHOOT 20-BOT FLOODER</h1>
    <p><strong>Updated for Nov 2025 â€“ Real API</strong></p>

    <div class="warn">
        PRIVATE GAMES ONLY. PUBLIC = BAN.
    </div>

    <div class="tip">
        ðŸ’¡ Create fresh PIN: <a href="https://kahoot.it" style="color:#ff0;">kahoot.it</a> â†’ New Quiz â†’ Start.
    </div>

    <input id="pin" placeholder="LIVE PIN (e.g. 123456)" maxlength="7">
    <input id="count" type="number" value="20" min="1" max="20">
    <button id="start">LAUNCH BOTS</button>
    <button id="stop" disabled>STOP</button>

    <div id="bots" class="log"><p>Bots status...</p></div>
</div>

<script>
const pinInput = document.getElementById('pin');
const countInput = document.getElementById('count');
const startBtn = document.getElementById('start');
const stopBtn = document.getElementById('stop');
const botsDiv = document.getElementById('bots');

let bots = [];

// Stable 2025 CORS proxy for reserve (bypasses blocks)
const PROXY = 'https://api.allorigins.win/raw?url=';

function log(msg) {
    const time = new Date().toLocaleTimeString();
    botsDiv.innerHTML += `<p>[${time}] ${msg}</p>`;
    botsDiv.scrollTop = botsDiv.scrollHeight;
}

function updateBot(name, status, color = '') {
    const id = `bot-${name}`;
    let el = document.getElementById(id);
    if (!el) {
        el = document.createElement('div');
        el.id = id; el.className = 'bot';
        el.innerHTML = `<strong>${name}</strong>: <span class="${color}">${status}</span>`;
        botsDiv.appendChild(el);
    } else {
        el.querySelector('span').textContent = status;
        el.querySelector('span').className = color;
    }
}

function randomName() {
    const names = ['Alpha','Beta','Gamma','Delta','Echo','Fox','Golf','Hotel','India','Juliet'];
    return names[Math.floor(Math.random() * names.length)] + Math.floor(Math.random() * 999);
}

// Reserve session with real token
async function getSession(pin) {
    const url = encodeURIComponent(`https://kahoot.it/reserve/session/${pin}`);
    const proxyUrl = PROXY + url;
    log(`Reserving session via proxy...`);
    const res = await fetch(proxyUrl);
    if (!res.ok) throw new Error(`Reserve failed: ${res.status}`);
    const token = res.headers.get('x-kahoot-session-token');
    const data = await res.json();
    if (!token || !data.sid) throw new Error('Invalid token/sid');
    log(`Session OK: Token=${token.slice(0,10)}... SID=${data.sid.slice(0,10)}...`);
    return { token, sid: data.sid };
}

// Bot join via WebSocket (real protocol)
class Bot {
    constructor(pin, name, token, sid) {
        this.pin = pin;
        this.name = name;
        this.token = token;
        this.sid = sid;
        this.ws = null;
    }

    async start() {
        updateBot(this.name, 'Reserving...', 'inf');
        try {
            const { token, sid } = await getSession(this.pin); // Shared reserve for simplicity
            this.token = token;
            this.sid = sid;
            this.connectWS();
        } catch (e) {
            updateBot(this.name, `Reserve fail: ${e.message}`, 'err');
            log(`Error for ${this.name}: ${e.message}`);
        }
    }

    connectWS() {
        const url = `wss://kahoot.it/cometd/${this.pin}/${this.sid}`;
        this.ws = new WebSocket(url);

        this.ws.onopen = () => {
            log(`${this.name}: WS open`);
            this.handshake();
        };

        this.ws.onmessage = (e) => this.onMessage(e);

        this.ws.onclose = (e) => {
            log(`${this.name}: Closed ${e.code}`);
            if (e.code === 1006) {
                setTimeout(() => this.connectWS(), 2000); // Retry
            }
        };

        this.ws.onerror = () => log(`${this.name}: WS error`);
    }

    handshake() {
        this.send([{
            channel: '/meta/handshake',
            version: '1.0',
            supportedConnectionTypes: [['websocket']],
            id: '1',
            ext: { 'com.kahoot.session.token': this.token }
        }]);
        updateBot(this.name, 'Handshake...', 'inf');
    }

    send(data) {
        if (this.ws && this.ws.readyState === 1) this.ws.send(JSON.stringify(data));
    }

    onMessage(e) {
        try {
            const msgs = JSON.parse(e.data);
            msgs.forEach(m => {
                if (m.successful && m.channel === '/meta/handshake') {
                    this.clientId = m.clientId;
                    this.connect();
                }
                if (m.successful && m.channel === '/meta/connect') {
                    this.join();
                }
                if (m.data?.type === 'loginResponse') {
                    if (m.data.success) {
                        updateBot(this.name, 'JOINED!', 'ok');
                        log(`${this.name}: In lobby!`);
                    } else {
                        updateBot(this.name, 'Rejected', 'err');
                    }
                }
            });
        } catch (ex) {}
    }

    connect() {
        this.send([{
            channel: '/meta/connect',
            clientId: this.clientId,
            connectionType: 'websocket',
            id: '2'
        }]);
    }

    join() {
        this.send([{
            channel: '/service/player',
            clientId: this.clientId,
            data: {
                type: 'login',
                gameid: +this.pin,
                host: 'kahoot.it',
                name: this.name
            },
            id: '3'
        }]);
        updateBot(this.name, 'Joining...', 'inf');
    }
}

// Launch
startBtn.onclick = async () => {
    const pin = pinInput.value.trim();
    if (!/^\d{6,7}$/.test(pin)) return alert('Invalid PIN');
    const count = Math.min(+countInput.value, 20);

    botsDiv.innerHTML = `<p>Launching ${count} bots for ${pin}...</p>`;
    bots = [];
    startBtn.disabled = true;
    stopBtn.disabled = false;

    // Shared reserve for speed
    let session;
    try {
        session = await getSession(pin);
    } catch (e) {
        log(`Global reserve fail: ${e.message}`);
        return;
    }

    for (let i = 0; i < count; i++) {
        const name = randomName();
        const bot = new Bot(pin, name, session.token, session.sid);
        bots.push(bot);
        setTimeout(() => bot.start(), i * 1000); // 1s stagger
    }
};

stopBtn.onclick = () => {
    bots.forEach(b => b.ws?.close());
    bots = [];
    startBtn.disabled = false;
    stopBtn.disabled = true;
    log('Stopped all');
};
</script>
</body>
</html>
